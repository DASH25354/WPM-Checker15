<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WPM Quiz with Audio</title>
<style>
  body { font-family: Arial, sans-serif; padding: 30px; }
  #text { border: 1px solid #ccc; padding: 30px; margin-bottom: 30px; background: #f9f9f9; }
  #controls { margin: 30px 0; }
  #questions { margin-top: 30px; }
</style>
</head>
<body>

<h2>Three-minute Training</h2>

<!-- 音声再生 -->
<h3>Listen to the audio:</h3>
<audio controls>
  <source src="85. Gemini 1.5.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

<!-- テキスト -->
<div id="text">
【1】Gemini Robotics 1.5 is a new AI model. It helps robots see, think, and act in the real world. Robots with Gemini Robotics 1.5 can do many jobs. They can work with people, use tools, and solve problems. They do not need to be trained for every job; they can learn and try new things. This model is safe, smart, and works well. It is easy for developers to use. Gemini Robotics 1.5 helps robots finish tasks step by step. It is good for schools, homes, and factories. Now, robots can help people more. They can understand and move around. Gemini Robotics 1.5 makes robots helpful in our life.
</div>

<!-- スタート・フィニッシュボタン -->
<div id="controls">
  <button onclick="startReading()">▶ Start</button>
  <button onclick="finishReading()">⏹ Finish</button>
</div>

<!-- 4択クイズ -->
<div id="questions">
  <h3>Quiz</h3>
  <label>Select all options below that match the content of the passage. (Select all that apply)</label><br>
  <input type="checkbox" class="q1" value="a"> It helps robots work with people.<br>
  <input type="checkbox" class="q1" value="b"> Robots using Gemini Robotics 1.5 need training for every job.
<br>
  <input type="checkbox" class="q1" value="c"> Robots can move and act in the real world with Gemini Robotics 1.5.<br>
  <input type="checkbox" class="q1" value="d"> Gemini Robotics 1.5 is not safe for school.
<br>
</div>

<div id="result"></div>

<script>
let startTime;
let wordCount = 0;

function startReading() {
  const text = document.getElementById("text").innerText.trim();
  wordCount = text.split(/\s+/).length;
  startTime = Date.now();
  document.getElementById("result").innerText = "Reading started...";
}

function finishReading() {
  if (!startTime) return alert("Please start reading first!");
  const elapsedSec = (Date.now() - startTime) / 1000;

  // 正答の配列（複数正解対応）
  const correctAnswers = ["a","c"];

  // 選択されたチェックボックスを取得
  const checked = Array.from(document.querySelectorAll(".q1:checked")).map(el => el.value);

  // 正答数計算（余分に選んだものもペナルティにする場合は調整可能）
  const numCorrect = checked.filter(val => correctAnswers.includes(val)).length;

  // 正答率 = 選択された正答の割合
  const accuracy = numCorrect / correctAnswers.length;

  const rawWPM = (wordCount / elapsedSec) * 60;
  const finalWPM = Math.round(rawWPM * accuracy);

  document.getElementById("result").innerHTML =
    `Time: ${elapsedSec.toFixed(1)} sec<br>` +
    `Raw WPM: ${rawWPM.toFixed(1)}<br>` +
    `Accuracy: ${(accuracy*100).toFixed(0)}%<br>` +
    `Final WPM (accuracy applied): ${finalWPM}`;
}
</script>

</body>
</html>
