<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WPM Quiz with Audio</title>
<style>
  body { font-family: Arial, sans-serif; padding: 30px; }
  #text { border: 1px solid #ccc; padding: 30px; margin-bottom: 30px; background: #f9f9f9; }
  #controls { margin: 30px 0; }
  #questions { margin-top: 30px; }
</style>
</head>
<body>

<h2>Three-minute Training</h2>

<style>
  audio {
    display: block;      /* ブロック表示にして余白を効かせる */
    margin-bottom: 3em;  /* 下に3行分の余白 */
  }
</style>
  
<!-- 音声再生 -->
<h3>Listen to the audio:</h3>
<audio controls>
  <source src="2.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

  
<!-- テキスト -->
<div id="text">
【3】Woven City is a new city near Mount Fuji in Japan. Toyota is building this city to test new technology and new ways to live. The city is built at the bottom of Mount Fuji, far from big cities like Tokyo. The first people to live there will be Toyota workers and old people. The city started in 2021. In Woven City, many smart machines and robots are used every day. People live in special houses with smart tools, and robots help with cleaning and safety. There are not many normal cars, so the roads are safe and clean. In the future, more people will move to Woven City. Toyota hopes the lessons from Woven City will help cities in other places. This project is important for a better future in Japan and the world.
</div>

<!-- スタート・フィニッシュボタン -->
<div id="controls">
  <button onclick="startReading()">▶ Start</button>
  <button onclick="finishReading()">⏹ Finish</button>
</div>

<!-- 4択クイズ -->
<div id="questions">
  <h3>Quiz</h3>
  <label>Select all options below that match the content of the passage.</label><br>
  <input type="checkbox" class="q1" value="a"> Woven City is near Mount Fuji and far from big cities like Tokyo.
<br>
  <input type="checkbox" class="q1" value="b"> Only normal cars are allowed on the roads in Woven City.
<br>
  <input type="checkbox" class="q1" value="c"> Woven City was finished many years ago.
<br>
  <input type="checkbox" class="q1" value="d"> Toyota is the company leading the Woven City project.
<br>
</div>

<div id="result"></div>

<script>
let startTime;
let wordCount = 0;

function startReading() {
  const text = document.getElementById("text").innerText.trim();
  wordCount = text.split(/\s+/).length;
  startTime = Date.now();
  document.getElementById("result").innerText = "Reading started...";
}

function finishReading() {
  if (!startTime) return alert("Please start reading first!");
  const elapsedSec = (Date.now() - startTime) / 1000;

  // 正答の配列（複数正解対応）
  const correctAnswers = ["a","d"];

  // 選択されたチェックボックスを取得
  const checked = Array.from(document.querySelectorAll(".q1:checked")).map(el => el.value);

  // 正答数計算（余分に選んだものもペナルティにする場合は調整可能）
  const numCorrect = checked.filter(val => correctAnswers.includes(val)).length;

  // 正答率 = 選択された正答の割合
  const accuracy = numCorrect / correctAnswers.length;

  const rawWPM = (wordCount / elapsedSec) * 60;
  const finalWPM = Math.round(rawWPM * accuracy);

  document.getElementById("result").innerHTML =
    `Time: ${elapsedSec.toFixed(1)} sec<br>` +
    `Raw WPM: ${rawWPM.toFixed(1)}<br>` +
    `Accuracy: ${(accuracy*100).toFixed(0)}%<br>` +
    `Final WPM (accuracy applied): ${finalWPM}`;
}
</script>

</body>
</html>



